{
    "sourceFile": "src/components/Search/index.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1652353636466,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1652353642052,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,8 +15,9 @@\n import firebase from \"firebase\";\n import \"../../../node_modules/bootstrap/dist/css/bootstrap.css\";\n import Bar from \"../Bar\";\n import \"../Bar/index.css\";\n+import { useCategories } from \"../App\";\n \n const styles = (theme) => ({\n     main: {\n         width: \"auto\",\n@@ -84,9 +85,9 @@\n     const [totalDataCount, setTotalDataCount] = useState(0);\n     const [dataRange] = useState(15);\n     const [pageNumber, setPageNumber] = useState(0);\n \n-    const categoryArray = \n+    const categoryArray = useCategories();\n \n     useEffect(() => {\n         getVideoByTag();\n     }, [pageNumber, totalDataCount]);\n"
                },
                {
                    "date": 1652353691976,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,8 @@\n import firebase from \"firebase\";\n import \"../../../node_modules/bootstrap/dist/css/bootstrap.css\";\n import Bar from \"../Bar\";\n import \"../Bar/index.css\";\n-import { useCategories } from \"../App\";\n \n const styles = (theme) => ({\n     main: {\n         width: \"auto\",\n@@ -85,9 +84,33 @@\n     const [totalDataCount, setTotalDataCount] = useState(0);\n     const [dataRange] = useState(15);\n     const [pageNumber, setPageNumber] = useState(0);\n \n-    const categoryArray = useCategories();\n+    const categoryArray = [\n+        \"中國\",\n+        \"歐美\",\n+        \"日本\",\n+        \"台灣\",\n+        \"香港\",\n+        \"東南亞\",\n+        \"韓國\",\n+        \"H漫\",\n+        \"有碼\",\n+        \"無碼\",\n+        \"生肉\",\n+        \"熟肉\",\n+        \"巨乳\",\n+        \"SM\",\n+        \"偷拍\",\n+        \"人妻\",\n+        \"學生\",\n+        \"群p\",\n+        \"同性\",\n+        \"露出\",\n+        \"制服\",\n+        \"近親\",\n+        \"其他\",\n+    ];\n \n     useEffect(() => {\n         getVideoByTag();\n     }, [pageNumber, totalDataCount]);\n"
                },
                {
                    "date": 1652353700507,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -84,33 +84,9 @@\n     const [totalDataCount, setTotalDataCount] = useState(0);\n     const [dataRange] = useState(15);\n     const [pageNumber, setPageNumber] = useState(0);\n \n-    const categoryArray = [\n-        \"中國\",\n-        \"歐美\",\n-        \"日本\",\n-        \"台灣\",\n-        \"香港\",\n-        \"東南亞\",\n-        \"韓國\",\n-        \"H漫\",\n-        \"有碼\",\n-        \"無碼\",\n-        \"生肉\",\n-        \"熟肉\",\n-        \"巨乳\",\n-        \"SM\",\n-        \"偷拍\",\n-        \"人妻\",\n-        \"學生\",\n-        \"群p\",\n-        \"同性\",\n-        \"露出\",\n-        \"制服\",\n-        \"近親\",\n-        \"其他\",\n-    ];\n+    const categoryArray = useCategories()\n \n     useEffect(() => {\n         getVideoByTag();\n     }, [pageNumber, totalDataCount]);\n"
                }
            ],
            "date": 1652353636466,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\nimport {\n    Typography,\n    Paper,\n    Card,\n    CardMedia,\n    CardContent,\n    CardActionArea,\n    Button,\n    IconButton,\n} from \"@material-ui/core\";\nimport LockOutlinedIcon from \"@material-ui/icons/LockOutlined\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport firebase from \"firebase\";\nimport \"../../../node_modules/bootstrap/dist/css/bootstrap.css\";\nimport Bar from \"../Bar\";\nimport \"../Bar/index.css\";\n\nconst styles = (theme) => ({\n    main: {\n        width: \"auto\",\n        display: \"block\", // Fix IE 11 issue.\n        marginLeft: theme.spacing.unit * 3,\n        marginRight: theme.spacing.unit * 3,\n        marginTop: theme.spacing.unit * 5,\n        [theme.breakpoints.up(\"auto\" + theme.spacing.unit * 3 * 2)]: {\n            width: \"auto\",\n            marginLeft: \"auto\",\n            marginRight: \"auto\",\n        },\n        backgroundColor: \"#210548\",\n    },\n    paper: {\n        marginTop: theme.spacing.unit * 8,\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        padding: `${theme.spacing.unit * 2}px ${theme.spacing.unit * 3}px ${\n            theme.spacing.unit * 3\n        }px`,\n        backgroundColor: \"#210548\",\n    },\n\n    Card: {\n        marginTop: theme.spacing.unit * 2,\n        height: theme.spacing.unit * 45,\n        backgroundColor: \"#210548\",\n    },\n    Tag: {\n        width: theme.spacing.unit * 10,\n\n        backgroundColor: \"#FFC0CB\",\n        textAlign: \"center\",\n        borderRadius: \"10px\",\n        borderColor: \"#ffffff\",\n        borderStyle: \"solid\",\n    },\n    Pagination: {\n        marginTop: theme.spacing.unit * 2,\n    },\n    CardMedia: {\n        paddingLeft: theme.spacing.unit * 1,\n        paddingRight: theme.spacing.unit * 1,\n        paddingTop: theme.spacing.unit * 1,\n    },\n    submit: {\n        marginTop: theme.spacing.unit * 3,\n        color: \"white\",\n        fontSize: \"20px\",\n    },\n    TimeTag: {\n        width: theme.spacing.unit * 8,\n        backgroundColor: \"#808080\",\n        textAlign: \"center\",\n        borderRadius: \"6px\",\n        borderColor: \"#ffffff\",\n    },\n});\n\nfunction Search(props) {\n    const { classes } = props;\n    const [videoList, setVideoList] = useState([]);\n    const [totalDataCount, setTotalDataCount] = useState(0);\n    const [dataRange] = useState(15);\n    const [pageNumber, setPageNumber] = useState(0);\n\n    const categoryArray = \n\n    useEffect(() => {\n        getVideoByTag();\n    }, [pageNumber, totalDataCount]);\n\n    return (\n        <div className={classes.main}>\n            <Bar></Bar>\n\n            <div className=\"row\">\n                <div className=\"col-md-3\">\n                    <Paper className={classes.paper}>\n                        <Typography\n                            component=\"h1\"\n                            variant=\"h5\"\n                            style={{ color: \"#FCFCFC\" }}\n                        >\n                            所有類別\n                        </Typography>\n                        <div className=\"well\">\n                            <ul className=\"list-group\">\n                                {categoryArray.map(function (value, index) {\n                                    return (\n                                        <li>\n                                            <Button\n                                                className={classes.submit}\n                                                id={index}\n                                                component={Link}\n                                                to={{\n                                                    pathname: `/filter/category/${value}`,\n                                                    state: {\n                                                        category: value,\n                                                    },\n                                                }}\n                                            >\n                                                {value}\n                                            </Button>\n                                        </li>\n                                    );\n                                })}\n                            </ul>\n                        </div>\n                    </Paper>\n                </div>\n                <div className=\"col-md-9\">\n                    <div className=\"row\" style={{ marginTop: \"20px\" }}>\n                        {videoList.map(function (value, index) {\n                            return (\n                                <div className=\"col-sm-4 col-md-3 col-lg-3\">\n                                    <Card className={classes.Card}>\n                                        <div className={classes.TimeTag}>\n                                            {convertTime(value.duration)}\n                                        </div>\n                                        <CardActionArea\n                                            component={Link}\n                                            to={{\n                                                pathname: `/player/id/${value.id}`,\n                                                state: {\n                                                    url: value.url,\n                                                    videoName: value.fileName,\n                                                    category: value.category,\n                                                    timestamp: value.timestamp,\n                                                    id: value.id,\n                                                },\n                                            }}\n                                        >\n                                            <CardMedia\n                                                preload=\"metadata\"\n                                                className={classes.CardMedia}\n                                                component={\n                                                    value.previewUrl ? \"img\" : \"video\"\n                                                }\n                                                alt=\"video\"\n                                                width=\"100%\"\n                                                height=\"200\"\n                                                title={value.fileName}\n                                                src={`${\n                                                    value.previewUrl || value.url\n                                                }#t=0.5`}\n                                            />\n                                        </CardActionArea>\n                                        <CardContent style={{ color: \"white\" }}>\n                                            <Typography\n                                                gutterBottom\n                                                variant=\"h8\"\n                                                component=\"div\"\n                                            >\n                                                {value.fileName}\n                                            </Typography>\n                                            <Typography\n                                                gutterBottom\n                                                variant=\"h8\"\n                                                component=\"div\"\n                                            >\n                                                {convertTimeStamp(value.timestamp)}\n                                            </Typography>\n                                            <Typography\n                                                gutterBottom\n                                                variant=\"h8\"\n                                                component=\"div\"\n                                            >\n                                                <div className={classes.Tag}>\n                                                    {value.category}\n                                                </div>\n                                            </Typography>\n                                        </CardContent>\n                                    </Card>\n                                </div>\n                            );\n                        })}\n                    </div>\n                </div>\n                <nav className={classes.Pagination}>\n                    <ul className=\"pagination pg-blue justify-content-center\">\n                        {Array(Math.ceil(totalDataCount / dataRange))\n                            .fill()\n                            .map(function (_, i) {\n                                return (\n                                    <div\n                                        className=\"pagination\"\n                                        style={{\n                                            borderRadius: \"20px\",\n                                            paddingLeft: \"5px\",\n                                            fontWeight: \"bold\",\n                                        }}\n                                    >\n                                        <li\n                                            className=\"page-item\"\n                                            key={i}\n                                            onClick={() => setPageNumber(i)}\n                                        >\n                                            <a className=\"page-link\" href=\"#\">\n                                                {i + 1}\n                                            </a>\n                                        </li>\n                                    </div>\n                                );\n                            })}\n                    </ul>\n                </nav>\n            </div>\n        </div>\n    );\n\n    function convertTime(num) {\n        var minutes = Math.floor(num / 60);\n        var seconds = Math.round(num % 60);\n\n        if (minutes < 10) {\n            minutes = \"0\" + minutes;\n        }\n\n        if (seconds < 10) {\n            seconds = \"0\" + seconds;\n        }\n\n        var timestamp = minutes + \":\" + seconds;\n\n        return timestamp;\n    }\n    function paginate(array, page_size, page_number) {\n        return array.slice((page_number - 1) * page_size, page_number * page_size);\n    }\n\n    function getVideoByTag() {\n        var videoArray = [];\n        var reversedArray = [];\n        var queryTag = props.match.params.tag;\n        firebase\n            .database()\n            .ref(\"VideoList/\")\n            .on(\"value\", function (snapshot) {\n                if (snapshot.val()) {\n                    snapshot.forEach(function (value) {\n                        if (value.val().tag) {\n                            var tagList = value.val().tag;\n                            tagList.map(function (list, index) {\n                                if (list === queryTag) {\n                                    var keys = Object.keys(value.val()).sort();\n                                    setTotalDataCount(keys.length);\n                                    var key = keys[pageNumber * dataRange];\n\n                                    videoArray.push(value.val());\n\n                                    reversedArray = [...videoArray].reverse();\n                                    setVideoList(\n                                        paginate(reversedArray, dataRange, pageNumber + 1)\n                                    );\n                                }\n                            });\n                        }\n                    });\n                }\n            });\n    }\n\n    function convertTimeStamp(timestamp) {\n        var date = new Date(timestamp);\n        var year = date.getFullYear();\n        var month = date.getMonth() + 1;\n        var day = date.getDate();\n\n        if (day < 10) {\n            day = \"0\" + day;\n        }\n        if (month < 10) {\n            month = \"0\" + month;\n        }\n\n        var newDate = year + \"-\" + month + \"-\" + day;\n\n        return newDate;\n    }\n}\n\nexport default withRouter(withStyles(styles)(Search));\n"
        }
    ]
}